@model IRCTCClone.Models.Booking

@{
    ViewData["Title"] = "Booking Confirmation";
}

@{
    var successMessage = TempData["BookingSuccess"] as string;
}

@if (!string.IsNullOrEmpty(successMessage))
{
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            Swal.fire({
                icon: "success",
                title: "Booking Successful!",
                text: "@successMessage",
                confirmButtonText: "OK",
                confirmButtonColor: "#3085d6",
                timer: 7000,
                timerProgressBar: true
            });
        });
    </script>
}

<div class="booking-confirmation">
    <h2 class="confirmation-title">🎟️ Booking Confirmation</h2>

    <div class="booking-info">
        <p><strong>PNR:</strong> @Model.PNR</p>
        <p><strong>Train:</strong> @Model.TrainNumber - @Model.TrainName</p>
        <p><strong>Journey Date:</strong> @Model.JourneyDate.ToString("dd-MM-yyyy")</p>

        @if (Model.Train != null && Model.JourneyDate != null)
        {
            var departureDateTime = Model.JourneyDate.Date + Model.Train.Departure;
            <p><strong>Scheduled Departure:</strong> @departureDateTime.ToString("dd-MM-yyyy HH:mm")</p>
        }

        <p><strong>Class:</strong> @Model.ClassCode</p>

        <h4>💰 Fare Breakdown</h4>
        <ul class="fare-breakdown">
            <li>
                <p><strong>Base Fare:</strong> ₹@Model.BaseFare</p>
                <p><strong>Quota:</strong> @Model.Quota</p>
                <p><strong>GST (5%):</strong> ₹@Model.GST</p>
                @if (Model.QuotaCharge != 0)
                {
                    <p><strong>Quota Charge:</strong> ₹@Model.QuotaCharge</p>
                }
                <p><strong>Surge Charge:</strong> ₹@Model.SurgeAmount</p>
                <p><strong>Total Fare:</strong> ₹@Model.TotalFare</p>
            </li>
        </ul>


        <p>
            <strong>Status:</strong>
            <span class="@(Model.Status == "CONFIRMED" ? "status-confirmed" : "status-cancelled")">
                @Model.Status
            </span>
        </p>
    </div>

    <h3 class="passenger-heading">👥 Passengers</h3>
    <ul class="passenger-list">
        @foreach (var p in Model.Passengers)
        {
            <li>@p.Name, @p.Age, @p.Gender — Seat: @p.SeatNumber</li>
        }
    </ul>
</div>


<style>
    .fare-breakdown {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 10px 20px;
        list-style-type: none;
    }

        .fare-breakdown li {
            padding: 4px 0;
            border-bottom: 1px dashed #ccc;
        }

            .fare-breakdown li:last-child {
                border-bottom: none;
                font-weight: bold;
                color: #0078d7;
            }
</style>
